package com.hzcf.security.util;

import org.junit.Test;

import com.hzcf.security.util.JWTUtils;

import io.jsonwebtoken.Claims;

public class JWTUtilsTest {

	@Test
	public void test() {
		JWTUtils util = new JWTUtils();
		String ab = util.createJWT("jwt", "{id:100,name:xiaohong}");
		System.out.println(ab);
		// eyJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJEU1NGQVdEV0FEQVMuLi4iLCJzdWIiOiJ7aWQ6MTAwLG5hbWU6eGlhb2hvbmd9IiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiJEQVNEQTEyMSIsImV4cCI6MTUyNjk1NTkxMywiaWF0IjoxNTI2OTU1ODUzLCJqdGkiOiJqd3QifQ.Rk0V7Jxc3M04n9mtVVU_UV1nYvxEXLodXEQ8qB6Plmc
		String jwt = "eyJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJEU1NGQVd1EV0FEQVMuLi4iLCJzdWIiOiJ7aWQ6MTAwLG5hbWU6eGlhb2hvbmd9IiwidXNlcl9uYW1lIjoiYWRtaW4iLCJuaWNrX25hbWUiOiJEQVNEQTEyMSIsImV4cCI6MTUyNjk1NzM1MCwiaWF0IjoxNTI2OTU2NzUwLCJqdGkiOiJqd3QifQ.tuzVB2UbezdBY5gxmjvmRda8NAO73GZ4WON-Bsmh80c";
		Claims c = util.parseJWT(jwt);// 注意：如果jwt已经过期了，这里会抛出jwt过期异常。
		System.out.println(c.getId());// jwt
		System.out.println(c.getIssuedAt());// Mon Feb 05 20:50:49 CST 2018
		System.out.println(c.getSubject());// {id:100,name:xiaohong}
		System.out.println(c.getIssuer());// null
		System.out.println(c.get("uid", String.class));// DSSFAWDWADAS...
	}

}
